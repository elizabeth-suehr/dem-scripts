import matplotlib
import matplotlib.pyplot as plt
import numpy as np

matplotlib.rcParams.update({"font.size": 13})

# Long
# vf_30=[30.379376270302238, 162.33044807140917, 161.5869479986518, 65.03381387133295]
# vf_40=[150.47238616066514, 409.70569904415487, 383.53084660405034, 269.2960110776131]
# vf_45=[282.44181018584175, 574.3485211442143, 518.9645929011363, 417.2395941510403]

# Full
# vf_30=[98.82812001484344, 222.10076942808274, 199.87782441434408, 91.91665405246316]
# vf_40=[247.5655128448271, 475.8980000248453, 428.8886826674907, 302.81783448014045]
# vf_45=[379.1528269949322, 648.425422341843, 572.4374731777234, 456.93386059239185]

# x^2
# vf_30=[20.548042073446783, 109.59756567369043, 124.74120383397171, 42.68003811904339]
# vf_40=[91.41867918333405, 364.7920948953241, 387.8935142067148, 266.60701925245985]
# vf_45=[194.41954147302815, 560.3095578757399, 556.1414489278782, 462.4287465568574]
# # x^3
# vf_30 = [6.408429599621825, 81.11854025214245,
#          116.68878386291458, 29.72600743900892]
# vf_40 = [50.637324518453845, 417.7509264131582,
#          520.1664272111566, 348.6145343114635]
# vf_45 = [149.52697852319312, 719.8362703375672,
#          796.7943082063337, 687.5171448929457]

# # 0.75
# vf_30 = [0.597413618938483, 42.93002290870572,
#          61.51603388757542, 15.375311207510256]
# vf_40 = [21.57182374323472, 199.15752118138383,
#          218.12700714721737, 149.606688954625]
# vf_45 = [79.84922212564445, 313.77375674870683,
#          313.0768676030564, 259.76321815033015]


# just data no fit
vf_30 = [3.2192124600000005, 551.7926250600001,
         881.1817903200003, 263.20738626000013]
vf_40 = [229.46284956000005, 3172.6400970000004,
         3709.6602953399997, 2459.854166580001]
vf_45 = [976.5162344400002, 5228.1154233000025,
         5688.086957940001, 4684.72216476]
# 1.0
# vf_30 = [0.06972636398776055, 19.494197645610555,
#          34.1098800470394, 6.571359727228898]
# vf_40 = [7.059691518680773, 126.67758673003289,
#          151.82859150967298, 102.72965377835007]
# vf_45 = [37.59715357580589, 213.38195887511583,
#          225.5332086704481, 190.6172887597875]
# # 1.25
# vf_30 = [0.0077206797953761315, 8.496108439731518,
#          18.225190183372128, 2.6929405890755715]
# vf_40 = [2.2074899494248528, 77.91986596537544,
#          102.48479974971022, 68.37658469067796]
# vf_45 = [17.001442726778617, 140.61422153028948,
#          157.7412941361301, 135.89761992080082]
# curl_2/vf_30/

# curl_2/vf_40/

# curl_2/vf_45/

# curl_3/vf_30/

# curl_3/vf_40/

# /Users/elizabethsuehr/Library/Mobile Documents/com~apple~CloudDocs/School/Research/particle_bend_series/interlocking_detection/graph_interlocking_histogram_data.py:42: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
#  fig = plt.figure(figsize=(8, 8))
# curl_3/vf_45/

# curl_4/vf_30/

# curl_4/vf_40/

# curl_4/vf_45/

# 0.29414124


# cutoff 0.4
vf_30_4 = [291.34689822, 2965.793440560001,
           3168.6528490799997, 1076.7857149200001]
vf_40_4 = [2140.62921528, 8366.716842360007,
           8187.421415400001, 5539.5129493800005]
vf_45_4 = [4775.9222903400005, 12253.858693680002,
           11319.045150600006, 9100.305094920002]

# cutoff 0.5
vf_30_5 = [166.77808308000007, 2395.79674098,
           2706.6386669399994, 874.8904360200002]
vf_40_5 = [1578.6723762600006, 7396.73707992,
           7428.3245808599995, 4970.415014700001]
vf_45_5 = [3852.77634978, 11032.502559300003,
           10427.960605200007, 8371.913337600003]

# cutoff 0.6
vf_30_6 = [74.4340749, 1757.9024385, 2116.55865714, 676.1163225000001]
vf_40_6 = [1004.88452292, 6220.515284699999,
           6417.671621399999, 4276.192664759999]
vf_45_6 = [2871.4721496, 9466.821421139999,
           9244.97356146001, 7407.832741139999]

# cutoff 0.7
vf_30_7 = [43.85972712, 1424.7711430199995,
           1811.0929794000006, 559.1951796000002]
vf_40_7 = [741.8242072800001, 5458.885567259998,
           5790.039579959999, 3851.9429496000002]
vf_45_7 = [2326.640867220001, 8491.547116380001,
           8476.545913140006, 6787.554230699999]

# cutoff 0.8
vf_30_8 = [14.935838520000003, 1063.0264413600003,
           1427.8106025000004, 439.43067138000004]
vf_40_8 = [497.60527218000016, 4551.083994719999,
           4978.242439919999, 3311.0498916000006]
vf_45_8 = [1701.1822027200008, 7240.809540360001,
           7419.304249500003, 5976.116596619999]

# cutoff 0.9
vf_30_9 = [8.971307820000002, 729.4702752000001,
           1077.1125385200003, 327.70602372]
vf_40_9 = [320.3198103600001, 3682.7300307000005,
           4232.02245522, 2799.6363223200015]
vf_45_9 = [1225.7355706200003, 5995.350165480003,
           6384.891214320001, 5191.72361544]

# cutoff 1.0
vf_30_10 = [3.2192124600000005, 551.7926250600001,
            881.1817903200003, 263.20738626000013]
vf_40_10 = [229.46284956000005, 3172.6400970000004,
            3709.6602953399997, 2459.854166580001]
vf_45_10 = [976.5162344400002, 5228.1154233000025,
            5688.086957940001, 4684.72216476]

vf_30 = [vf_30_4, vf_30_5, vf_30_6, vf_30_7, vf_30_8, vf_30_9, vf_30_10]
vf_40 = [vf_40_4, vf_40_5, vf_40_6, vf_40_7, vf_40_8, vf_40_9, vf_40_10]
vf_45 = [vf_45_4, vf_45_5, vf_45_6, vf_45_7, vf_45_8, vf_45_9, vf_45_10]

interlocking_time_40 = [
    48.54195303,
    213.0603165,
    224.3375447,
    192.007195


]
interlocking_time_45 = [
    115.9440068,
    296.8705726,
    306.4900975,
    276.3428235
]


stress_30 = [0.38518694624007566, 0.41478986014567826,
             0.4087975686937332, 0.3836904126260188]
stress_40 = [
    1.260166913,
    1.562590936,
    1.619378181,
    1.477205731,
]


stress_45 = [
    3.192656701,
    4.503070535,
    4.738922214,
    4.164594751,
]

names = ["0.4", "0.5", "0.6", "0.7", "0.8", "0.9", "1.0",]
for i, (v_30, v_40, v_45) in enumerate(zip(vf_30, vf_40, vf_45)):
    interlocking_time_30 = np.array(v_30)
    interlocking_time_40 = np.array(v_40)
    interlocking_time_45 = np.array(v_45)

    plt.figure(i)

    plt.scatter(interlocking_time_30, stress_30, color="C2")
    m, b = np.polyfit(interlocking_time_30, stress_30, 1)

    regression_1 = m * min(interlocking_time_30) + b
    regression_2 = m * max(interlocking_time_30) + b
    plt.plot(
        [min(interlocking_time_30), max(interlocking_time_30)],
        [regression_1, regression_2],
        color="C2",
        linestyle="dashed",
        label="volume fraction 0.30",
    )

    plt.scatter(interlocking_time_40, stress_40, color="C0")
    m, b = np.polyfit(interlocking_time_40, stress_40, 1)

    regression_1 = m * min(interlocking_time_40) + b
    regression_2 = m * max(interlocking_time_40) + b
    plt.plot(
        [min(interlocking_time_40), max(interlocking_time_40)],
        [regression_1, regression_2],
        color="C0",
        linestyle="dashed",
        label="volume fraction 0.40",
    )

    plt.scatter(interlocking_time_45, stress_45, color="C1")
    m, b = np.polyfit(interlocking_time_45, stress_45, 1)

    regression_1 = m * min(interlocking_time_45) + b
    regression_2 = m * max(interlocking_time_45) + b
    plt.plot(
        [min(interlocking_time_45), max(interlocking_time_45)],
        [regression_1, regression_2],
        color="C1",
        linestyle="dashed",
        label="volume fraction 0.45",
    )

    plt.ylabel("Shear Stress $(σ_{xy}) / (ρd_{v}^{2} γ^{2})$")
    plt.xlabel("Long Duration Interlocking Time (no Fit)")
    plt.legend()
    plt.savefig("interlocking_no_fit_"+names[i]+".pdf", bbox_inches="tight")
